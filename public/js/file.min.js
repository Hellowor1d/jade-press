!function(){var e=Vue.$alert;Vue.use(zPagenav);var t=new Vue({el:"body",data:{loaded:!0,form1:null,list:[],uploadProgress:0,formData1:{page:1,pageSize:20,maxLink:5,fields:{_id:1,md5:1,filename:1,ext:1}},total:0,onSubmit1:!1,onDel:!1,currentDelItem:{},state:"list"},methods:{isImg:function(e){var t=e.ext;return"jpg"===t||"png"===t||"webp"===t},createImgSrc:function(e){return h5.host+"/file/"+e._id+"."+e.ext},checkShow:function(e){return"list"===this.state?!0:e._id===this.currentDelItem._id},remove:function(e,t){for(var r=0,i=t.length;i>r;r++)if(e._id===t[r]._id)return t.splice(r,1)},del:function(e){this.state="del",this.currentDelItem=Object.assign({},e)},cancel:function(e){this.state="list",this.currentDelItem={}},delConfirm:function(t,r){var i=this;if(!i.onDel){var n={_id:this.currentDelItem._id};i.onDel=!0;var o=h5.host+"/api/file/del";$.ajax({type:"post",url:o,data:n}).then(function(t){i.onDel=!1;var n=t;n.errorMsg||n.errs?e(n.errorMsg||n.errs.join(";"),"danger","#msg-item",1e4):(i.list.splice(r,1),i.total--,i.state="list",e("delete done","success","#msg3",1e4))},function(t){i.onDel=!1,e("del failed","danger","#msg-item",1e4)})}},getList:function(){var t=this;t.onSubmit1||t.form1.$invalid||(t.onSubmit1=!0,$.ajax({type:"post",url:h5.host+"/api/file/get",data:t.formData1}).then(function(r){t.onSubmit1=!1;var i=r;i.errorMsg||i.errs?e(i.errorMsg||i.errs.join(";"),"danger","#msg3"):(t.total=i.total,t.list=i.result)},function(r){t.onSubmit1=!1,e("get list failed","danger","#msg3")}))}},events:{"page-change":function(e){this.getList()}}});t.getList(),$(function(){$("#file2").fileupload({dataType:"json",formData:{},url:h5.host+"/api/file/add",done:function(r,i){var n=i.result;return n.errorMsg||n.errs?e(n.errorMsg||n.errs.join(";"),"danger","#file-err2"):(t.list.push(n.result),void t.total++)},error:function(t,r){return e(r+" please retry","danger","#file-err2")},progressall:function(e,r){t.uploadProgress=Math.floor(100*r.loaded/r.total)},add:function(e,t){t.submit()}})})}();